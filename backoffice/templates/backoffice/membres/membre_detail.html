{% extends "backoffice/base.html" %}

{% block content %}

<div class="max-w-6xl mx-auto space-y-8">

<h1 class="text-2xl font-semibold">
üë§ Fiche membre
</h1>

<!-- ================= STATUT GLOBAL ================= -->
<div class="alert
{% if roster_profile and roster_profile.statut == 'VALIDE' %}
    alert-success
{% elif roster_profile and roster_profile.statut == 'SOUMIS' %}
    alert-warning
{% else %}
    alert-ghost
{% endif %} shadow">

<div>
<b>{{ membre.get_full_name }}</b>

{% if roster_profile and roster_profile.statut == "VALIDE" %}
 ‚Äî Consultant AMEE valid√©
{% elif roster_profile and roster_profile.statut == "SOUMIS" %}
 ‚Äî Dossier consultant en √©valuation
{% else %}
 ‚Äî Membre adh√©rent
{% endif %}
</div>

</div>


<!-- ================= IDENTITE & ADHESION ================= -->
<div class="grid lg:grid-cols-2 gap-6">

    <!-- IDENTITE -->
    <div class="card bg-base-100 shadow">
        <div class="card-body space-y-2">
            <h2 class="card-title">Identit√©</h2>

            <p><b>Email :</b> {{ membre.email }}</p>
            <p><b>T√©l√©phone :</b> {{ membre.phone|default:"-" }}</p>
            <p><b>T√©l√©phone secondaire :</b> {{ membre.secondary_phone|default:"-" }}</p>
            <p><b>Organisation :</b> {{ membre.organization|default:"-" }}</p>

            <div class="divider my-2"></div>

            <p><b>ID AMEE :</b> {{ membre.id_membre_association|default:"-" }}</p>
            <p><b>R√¥le :</b> {{ membre.get_role_display }}</p>
        </div>
    </div>

    <!-- ADHESION -->
    <div class="card bg-base-100 shadow">
        <div class="card-body space-y-2">
            <h2 class="card-title">Adh√©sion</h2>

            {% if membership and membership.est_actif %}
                <span class="badge badge-success w-fit">Active</span>
            {% else %}
                <span class="badge badge-warning w-fit">Inactive</span>
            {% endif %}

            <p><b>Date activation :</b>
                {{ membership.date_activation|default:"-" }}
            </p>

            <p><b>Date expiration :</b>
                {{ membership.date_expiration|default:"-" }}
            </p>
        </div>
    </div>

</div>


<!-- ================= CONSULTANT ================= -->
<div class="card bg-base-100 shadow">
<div class="card-body">

<h2 class="card-title">üßæ Statut Consultant (Roster)</h2>

{% if roster_profile %}

    <div class="flex gap-2 mb-3">
        {% if roster_profile.statut == "VALIDE" %}
            <span class="badge badge-success">Valid√©</span>
        {% elif roster_profile.statut == "SOUMIS" %}
            <span class="badge badge-warning">En √©valuation</span>
        {% elif roster_profile.statut == "REFUSE" %}
            <span class="badge badge-error">Refus√©</span>
        {% else %}
            <span class="badge badge-ghost">Brouillon</span>
        {% endif %}
    </div>

    <p><b>Domaine d√©clar√© :</b>
        {{ roster_profile.domaine_expertise }}
    </p>

    <p><b>Ann√©es d‚Äôexp√©rience :</b>
        {{ roster_profile.annees_experience }} ans
    </p>

    <p><b>√âligibilit√© :</b>
        {{ roster_profile.get_eligibilite_option_display }}
    </p>

    <p><b>Cr√©√© le :</b>
        {{ roster_profile.cree_le|date:"d/m/Y" }}
    </p>

    {% if roster_profile.cv_document %}
    <a href="{{ roster_profile.cv_document.url }}"
       target="_blank"
       class="btn btn-xs btn-outline mt-3">
        Voir CV soumis
    </a>
    {% endif %}

{% else %}
    <span class="badge badge-ghost">
        Aucun dossier consultant
    </span>
{% endif %}

</div>
</div>


<!-- ================= PROFIL PUBLIC CONSULTANT ================= -->
{% if roster_profile and roster_profile.public_profile %}

<div class="card bg-base-100 shadow">
<div class="card-body space-y-2">

<h2 class="card-title">üåç Profil visible clients</h2>

<p><b>Titre :</b>
{{ roster_profile.public_profile.titre_professionnel }}</p>

<p><b>S√©niorit√© :</b>
{{ roster_profile.public_profile.get_niveau_seniorite_display|default:"-" }}</p>

<p><b>Disponibilit√© :</b>
{{ roster_profile.public_profile.get_statut_disponibilite_display }}</p>

<p><b>Pays r√©sidence :</b>
{{ roster_profile.public_profile.pays_residence|default:"-" }}</p>

<p><b>Langues :</b>
{{ roster_profile.public_profile.langues|default:"-" }}</p>

<p><b>Profil publi√© :</b>
{% if roster_profile.public_profile.consentement_publication %}
<span class="badge badge-success">Oui</span>
{% else %}
<span class="badge badge-warning">Non</span>
{% endif %}
</p>

</div>
</div>

{% endif %}


<!-- ================= FINANCIER ================= -->
<div class="card bg-base-100 shadow">
<div class="card-body">

<h2 class="card-title">üí∞ Situation financi√®re</h2>

{% if derniere_transaction %}
    <p><b>Derni√®re op√©ration :</b>
        {{ derniere_transaction.categorie }}
    </p>

    <p><b>Montant :</b>
        {{ derniere_transaction.montant }} FCFA
    </p>

    <p><b>Enregistr√© par :</b>
        {{ derniere_transaction.cree_par.email }}
    </p>

    <p><b>Date :</b>
        {{ derniere_transaction.date_transaction }}
    </p>
{% else %}
    <p>Aucune transaction enregistr√©e.</p>
{% endif %}

</div>
</div>

</div>

{% endblock %}
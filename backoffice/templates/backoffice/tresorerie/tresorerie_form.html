{% extends "backoffice/base.html" %}

{% block content %}

<div class="max-w-2xl">

    <h1 class="text-2xl font-semibold mb-6">
        üí∞ Enr√¥lement & Paiement membre
    </h1>

    <form method="post" class="card bg-base-100 shadow">

        <div class="card-body space-y-4">
{% csrf_token %}
<input type="hidden" name="paiement_token" value="{{ paiement_token }}">

            <!-- IDENTITE -->
            <div class="divider">Identit√© du membre</div>

            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <label class="label">{{ form.first_name.label }}</label>
                    {{ form.first_name }}
                </div>

                <div>
                    <label class="label">{{ form.last_name.label }}</label>
                    {{ form.last_name }}
                </div>
            </div>

            <div>
                <label class="label">{{ form.email.label }}</label>
                {{ form.email }}
            </div>

            <div>
                <label class="label">{{ form.phone.label }}</label>
                {{ form.phone }}
            </div>

            <!-- ORGANISATION -->
            <div>
<label class="label">
    <span class="label-text">Organisation (optionnel)</span>
</label>
{{ form.organization }}
            </div>


            <!-- PAIEMENT -->
<div class="divider">Paiement</div>

<div>
    <label class="label">
        <span class="label-text">Type d'op√©ration</span>
    </label>
    {{ form.operation }}
</div>

<div class="grid md:grid-cols-2 gap-4">

    <div>
        <label class="label">
            <span class="label-text">Montant adh√©sion</span>
        </label>
        {{ form.montant_adhesion }}
    </div>

    <div>
        <label class="label">
            <span class="label-text">Montant cotisation</span>
        </label>
        {{ form.montant_cotisation }}
    </div>

</div>

<div>
    <label class="label">
        <span class="label-text">Description</span>
    </label>
    {{ form.description }}
</div>

            <!-- SUBMIT -->
            <div class="pt-4">
<button id="submitBtn" class="btn btn-success w-full">
    ‚úÖ Enregistrer et valider
</button>

            </div>

        </div>

    </form>


{% if result %}

<div class="card bg-success text-success-content mt-8">
    <div class="card-body">

        <h2 class="card-title">
            ‚úÖ Op√©ration r√©ussie
        </h2>

        <p>
            Enregistr√© par :
            <strong>{{ result.cree_par.email }}</strong>
        </p>

        <hr class="opacity-30">

        <p>
            Membre :
            <strong>{{ result.user.id_membre_association }}</strong>
            ({{ result.user.email }})
        </p>

        {% if result.membership and result.membership.est_actif %}
            <p class="font-semibold">
                üåø Membership ACTIF
            </p>

            <p>
                Expire le :
                {{ result.membership.date_expiration }}
            </p>
        {% else %}
            <p class="text-warning font-semibold">
                ‚è≥ Cotisation requise pour activation
            </p>
        {% endif %}

    </div>
</div>

{% endif %}

</div>

<script>
document.querySelector("form").addEventListener("submit", function(){
    document.getElementById("submitBtn").disabled = true;
    document.getElementById("submitBtn").classList.add("loading");
});
</script>

{% endblock %}